#!/bin/bash

# Show Hyprland keybindings using fzf

KEYBINDS_FILE="$HOME/.config/hypr/conf/keybinds.conf"

if [ ! -f "$KEYBINDS_FILE" ]; then
    echo "Keybinds file not found: $KEYBINDS_FILE"
    read -p "Press enter to close..."
    exit 1
fi

# Parse bindd lines: bindd = MODS, KEY, DESCRIPTION, action...
# Format output as: "MODS + KEY | DESCRIPTION"
grep -E '^bindd\s*=' "$KEYBINDS_FILE" | \
    sed 's/bindd\s*=\s*//' | \
    awk -F', ' '{
        mods = $1
        key = $2
        desc = $3
        # Replace $mainMod with SUPER for display
        gsub(/\$mainMod/, "SUPER", mods)
        # Format: MODS+KEY → Description
        if (mods == "") {
            printf "%-20s  │  %s\n", key, desc
        } else {
            printf "%-20s  │  %s\n", mods " + " key, desc
        }
    }' | \
    fzf --ansi \
        --header="Hyprland Keybindings (ESC to close)" \
        --header-first \
        --layout=reverse \
        --border=rounded \
        --margin=1 \
        --padding=1 \
        --no-info \
        --bind 'enter:abort'

